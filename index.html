<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trivial Grid</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
      color: #1e293b;
    }

    .container {
      max-width: 480px;
      width: 100%;
    }

    header {
      text-align: center;
      margin-bottom: 32px;
    }

    h1 {
      font-size: 2rem;
      font-weight: 700;
      color: white;
      text-shadow: 0 4px 12px rgba(0,0,0,0.3);
      margin-bottom: 4px;
    }

    .subtitle {
      color: rgba(255,255,255,0.9);
      font-size: 0.95rem;
      font-weight: 500;
    }

    .game-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 24px;
      padding: 32px 24px;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .stats {
      display: flex;
      justify-content: space-between;
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 1px solid #e2e8f0;
    }

    .stat {
      text-align: center;
    }

    .stat-label {
      font-size: 0.7rem;
      color: #94a3b8;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-weight: 600;
      margin-bottom: 2px;
    }

    .stat-value {
      font-size: 1.3rem;
      font-weight: 700;
      color: #1e293b;
    }

    .grid {
      display: flex;
      flex-direction: column;
      gap: 20px;
      margin-bottom: 28px;
    }

    .category-row {
      display: grid;
      grid-template-columns: 80px 1fr 1fr 1fr;
      grid-template-rows: auto auto;
      gap: 12px 8px;
      align-items: start;
    }

    .category-label {
      grid-column: 1 / 5;
      grid-row: 1;
      font-size: 0.75rem;
      color: #64748b;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      font-weight: 700;
      padding: 6px 12px;
      background: rgba(99, 102, 241, 0.1);
      border-radius: 8px;
      align-self: center;
      text-align: center;
    }

    .question-cell {
      grid-column: 2 / 5;
      grid-row: 2;
      background: rgba(248, 250, 252, 0.8);
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      padding: 12px;
      font-size: 0.85rem;
      font-weight: 500;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s ease;
      line-height: 1.3;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .option {
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      height: 56px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      font-weight: 600;
      text-align: center;
      padding: 4px 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      background: #ffffff;
      line-height: 1.2;
    }

    .question-cell:hover,
    .option:hover:not(.correct):not(.incorrect):not(.locked) {
      border-color: #6366f1;
      background: rgba(99, 102, 241, 0.08);
      transform: translateY(-1px);
      box-shadow: 0 8px 20px rgba(99, 102, 241, 0.15);
    }

    .correct {
      background: linear-gradient(135deg, #10b981, #059669) !important;
      color: white !important;
      border-color: #10b981 !important;
      cursor: default !important;
    }

    .incorrect {
      background: linear-gradient(135deg, #ef4444, #dc2626) !important;
      color: white !important;
      border-color: #ef4444 !important;
    }

    .locked {
      cursor: default !important;
      opacity: 0.8;
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-3px); }
      75% { transform: translateX(3px); }
    }

    .shake {
      animation: shake 0.3s ease-in-out;
    }

    .reset-btn {
      width: 100%;
      height: 48px;
      border: none;
      border-radius: 16px;
      background: linear-gradient(135deg, #6366f1, #8b5cf6);
      color: white;
      font-size: 0.95rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .reset-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 30px rgba(99, 102, 241, 0.4);
    }

    .footer {
      text-align: center;
      margin-top: 24px;
      color: rgba(255,255,255,0.9);
      font-size: 0.8rem;
    }

    @media (max-width: 480px) {
      .category-row {
        grid-template-columns: 70px 1fr 1fr 1fr;
        gap: 10px 6px;
      }
      
      .question-cell,
      .option {
        font-size: 0.78rem;
        height: 50px;
        padding: 8px;
      }
      
      .category-label {
        font-size: 0.7rem;
        padding: 4px 8px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Trivial Grid</h1>
      <div class="subtitle">Cultura general espaÃ±ola</div>
    </header>

    <div class="game-card">
      <div class="stats">
        <div class="stat">
          <div class="stat-label">Intentos</div>
          <div class="stat-value" id="attempts">0</div>
        </div>
        <div class="stat">
          <div class="stat-label">Progreso</div>
          <div class="stat-value" id="progress">0/6</div>
        </div>
      </div>

      <div class="grid" id="grid"></div>
      
      <button class="reset-btn" onclick="resetGame()">Nueva Partida</button>
    </div>

    <div class="footer">
      <p>VersiÃ³n Beta Â· Â© 2025 Trivial Grid</p>
    </div>
  </div>

  <script src="questions.js"></script>
  <script>
    const categories = Object.keys(trivialQuestions);
    let gameState = {
      attempts: 0,
      correctAnswers: new Set(),
      currentRound: {}
    };

    function initGrid() {
      const grid = document.getElementById('grid');
      grid.innerHTML = '';

      categories.forEach((cat, catIndex) => {
        const row = document.createElement('div');
        row.className = 'category-row';
        row.dataset.category = catIndex;

        // Nombre categorÃ­a (fila 1, columna completa)
        const label = document.createElement('div');
        label.className = 'category-label';
        label.textContent = cat;
        row.appendChild(label);

        // OpciÃ³n 0 (fila 2, columna 1)
        const opt0 = document.createElement('div');
        opt0.className = 'option option-0';
        opt0.dataset.option = '0';
        row.appendChild(opt0);

        // Pregunta (fila 2, columnas 2-4) - ahora es mÃ¡s pequeÃ±a
        const question = document.createElement('div');
        question.className = 'question-cell';
        question.textContent = 'Pregunta aquÃ­';
        row.appendChild(question);

        // OpciÃ³n 1 (fila 2, columna 4)
        const opt1 = document.createElement('div');
        opt1.className = 'option option-1';
        opt1.dataset.option = '1';
        row.appendChild(opt1);

        grid.appendChild(row);
      });

      startNewRound();
      renderGrid();
      attachListeners();
      updateStats();
    }

    function startNewRound() {
      gameState.currentRound = {};
      categories.forEach((cat, catIndex) => {
        if (!gameState.correctAnswers.has(catIndex)) {
          const questions = trivialQuestions[cat];
          gameState.currentRound[catIndex] = questions[Math.floor(Math.random() * questions.length)];
        }
      });
    }

    function renderGrid() {
      categories.forEach((cat, catIndex) => {
        const row = document.querySelector(`[data-category="${catIndex}"]`);
        const opt0 = row.querySelector('.option-0');
        const questionCell = row.querySelector('.question-cell');
        const opt1 = row.querySelector('.option-1');
        const questionData = gameState.currentRound[catIndex];

        if (gameState.correctAnswers.has(catIndex)) {
          opt0.className = 'option correct locked';
          opt0.textContent = 'âœ“';
          questionCell.className = 'question-cell correct locked';
          questionCell.textContent = 'âœ“';
          opt1.className = 'option correct locked';
          opt1.textContent = 'âœ“';
          return;
        }

        // Render pregunta activa
        opt0.className = 'option option-0';
        opt0.textContent = questionData.options[0];
        opt1.className = 'option option-1';
        opt1.textContent = questionData.options[1];
        questionCell.textContent = questionData.options[2];
        questionCell.dataset.option = '2';
      });
    }

    function attachListeners() {
      document.querySelectorAll('.category-row .option, .category-row .question-cell').forEach(cell => {
        cell.onclick = function() {
          const row = this.closest('.category-row');
          const catIndex = parseInt(row.dataset.category);
          const optIndex = parseInt(this.dataset.option || 2);
          handleAnswer(catIndex, optIndex, this);
        };
      });
    }

    function handleAnswer(catIndex, optionIndex, clickedElement) {
      if (gameState.correctAnswers.has(catIndex)) return;

      const questionData = gameState.currentRound[catIndex];
      const correctIndex = questionData.correct;

      gameState.attempts++;
      updateStats();

      const row = clickedElement.closest('.category-row');
      const allCells = row.querySelectorAll('.option, .question-cell');

      if (optionIndex === correctIndex) {
        gameState.correctAnswers.add(catIndex);
        allCells.forEach(cell => {
          cell.classList.add('correct', 'locked');
          cell.textContent = 'âœ“';
        });

        if (gameState.correctAnswers.size === categories.length) {
          setTimeout(() => alert(`ðŸŽ‰ Â¡TRIVIAL COMPLETADO!\n${gameState.attempts} intentos`), 400);
        }
      } else {
        clickedElement.classList.add('incorrect', 'shake');
        setTimeout(() => clickedElement.classList.remove('shake'), 300);
      }
    }

    function updateStats() {
      document.getElementById('attempts').textContent = gameState.attempts;
      document.getElementById('progress').textContent = `${gameState.correctAnswers.size}/6`;
    }

    function resetGame() {
      gameState = { attempts: 0, correctAnswers: new Set(), currentRound: {} };
      initGrid();
    }

    // Esperar a que questions.js cargue
    window.addEventListener('load', initGrid);
  </script>
</body>
</html>
