<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trivial Grid</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 600px;
            width: 100%;
            flex: 1;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #000;
            margin-bottom: 30px;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-bottom: 25px;
        }

        .stat {
            text-align: center;
        }

        .stat-label {
            font-size: 0.75rem;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #000;
        }

        .game-card {
            background: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .grid {
            display: grid;
            grid-template-columns: auto repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 25px;
        }

        .category-label {
            display: flex;
            align-items: center;
            font-size: 0.75rem;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding-right: 12px;
            font-weight: 600;
        }

        .cell {
            aspect-ratio: 1;
            border: 2px solid #e5e5e5;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
            background: white;
        }

        .cell:hover:not(.correct):not(.incorrect) {
            border-color: #999;
            background: #fafafa;
        }

        .cell.correct {
            background: #000;
            color: white;
            border-color: #000;
            cursor: default;
        }

        .cell.incorrect {
            background: #ff4444;
            color: white;
            border-color: #ff4444;
        }

        .cell.incorrect:not(.locked) {
            cursor: pointer;
        }

        .cell.locked {
            cursor: default;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            75% { transform: translateX(8px); }
        }

        .shake {
            animation: shake 0.4s;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.6);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 8px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }

        .question-category {
            display: inline-block;
            background: #000;
            color: white;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 20px;
        }

        .question {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 25px;
            color: #000;
            line-height: 1.5;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option {
            padding: 16px 20px;
            border: 2px solid #e5e5e5;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
            font-size: 1rem;
            text-align: left;
        }

        .option:hover {
            border-color: #000;
            background: #fafafa;
        }

        .btn {
            width: 100%;
            padding: 14px 24px;
            border: 2px solid #000;
            border-radius: 4px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            background: #000;
            color: white;
        }

        .btn:hover {
            background: #333;
            border-color: #333;
        }

        .result-message {
            text-align: center;
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .result-message.correct {
            color: #000;
        }

        .result-message.incorrect {
            color: #ff4444;
        }

        .victory-modal {
            text-align: center;
        }

        .victory-title {
            font-size: 3rem;
            margin-bottom: 20px;
        }

        .victory-message {
            font-size: 1.5rem;
            font-weight: 700;
            color: #000;
            margin-bottom: 15px;
        }

        .victory-stats {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 4px;
            margin: 20px 0;
        }

        .victory-stats p {
            font-size: 1rem;
            margin: 8px 0;
            color: #333;
        }

        footer {
            width: 100%;
            max-width: 600px;
            text-align: center;
            color: #666;
            padding: 20px;
            margin-top: 20px;
            font-size: 0.85rem;
        }

        .footer-text {
            margin: 8px 0;
            opacity: 0.9;
        }

        .footer-text a {
            color: #666;
            text-decoration: underline;
        }

        .footer-text a:hover {
            color: #000;
        }

        .copyright {
            opacity: 0.7;
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid #e5e5e5;
            background: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.2s;
        }

        .theme-toggle:hover {
            border-color: #000;
        }

        @media (max-width: 600px) {
            h1 {
                font-size: 2rem;
            }

            .game-card {
                padding: 20px;
            }

            .category-label {
                font-size: 0.65rem;
                padding-right: 8px;
            }

            .cell {
                font-size: 1.2rem;
            }

            .grid {
                gap: 6px;
            }
        }
    </style>
</head>
<body>
    <div class="theme-toggle" onclick="toggleTheme()">ðŸŒ™</div>

    <div class="container">
        <header>
            <h1>Trivial Grid</h1>
            
            <div class="stats">
                <div class="stat">
                    <div class="stat-label">Intentos</div>
                    <div class="stat-value" id="attempts">0</div>
                </div>
                <div class="stat">
                    <div class="stat-label">Progreso</div>
                    <div class="stat-value" id="progress">0/6</div>
                </div>
            </div>
        </header>

        <div class="game-card">
            <div class="grid" id="grid"></div>
            <button class="btn" onclick="resetGame()">Nueva Partida</button>
        </div>
    </div>

    <footer>
        <p class="footer-text">
            <strong>VersiÃ³n Beta</strong> Â· No se recopilan ni utilizan datos personales
        </p>
        <p class="footer-text">
            Preguntas de cultura general espaÃ±ola
        </p>
        <p class="footer-text copyright">
            Â© 2025 Trivial Grid Â· 
            <a href="https://opensource.org/licenses/MIT" target="_blank" rel="noopener noreferrer">
                Licencia MIT
            </a>
        </p>
    </footer>

    <div class="modal" id="modal">
        <div class="modal-content" id="modalContent"></div>
    </div>

    <script src="questions.js"></script>
    <script>
        const categories = [
            'GeografÃ­a',
            'Entretenimiento',
            'Historia',
            'Arte y Literatura',
            'Ciencias y Naturaleza',
            'Deportes y Pasatiempos'
        ];

        let gameState = {
            attempts: 0,
            correctAnswers: new Set(),
            currentRound: {}
        };

        function initGrid() {
            const grid = document.getElementById('grid');
            grid.innerHTML = '';

            categories.forEach((cat, catIndex) => {
                const label = document.createElement('div');
                label.className = 'category-label';
                label.textContent = cat;
                grid.appendChild(label);

                for (let i = 0; i < 3; i++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.dataset.category = catIndex;
                    cell.dataset.option = i;
                    cell.textContent = '';
                    cell.onclick = () => showQuestion(catIndex, i);
                    grid.appendChild(cell);
                }
            });

            startNewRound();
        }

        function startNewRound() {
            gameState.currentRound = {};
            
            categories.forEach((cat, catIndex) => {
                if (!gameState.correctAnswers.has(catIndex)) {
                    const categoryQuestions = trivialQuestions[cat];
                    const randomQuestion = categoryQuestions[Math.floor(Math.random() * categoryQuestions.length)];
                    gameState.currentRound[catIndex] = randomQuestion;
                }
            });
        }

        function showQuestion(catIndex, optionIndex) {
            if (gameState.correctAnswers.has(catIndex)) return;

            const category = categories[catIndex];
            const questionData = gameState.currentRound[catIndex];

            const modal = document.getElementById('modal');
            const content = document.getElementById('modalContent');

            content.innerHTML = `
                <div class="question-category">${category}</div>
                <div class="question">${questionData.q}</div>
                <div class="options">
                    ${questionData.options.map((opt, i) => `
                        <div class="option" onclick="checkAnswer(${catIndex}, ${optionIndex}, ${i}, ${questionData.correct})">${opt}</div>
                    `).join('')}
                </div>
            `;

            modal.classList.add('active');
        }

        function checkAnswer(catIndex, optionIndex, selected, correct) {
            gameState.attempts++;
            updateStats();

            const cells = document.querySelectorAll(`[data-category="${catIndex}"]`);
            const selectedCell = document.querySelector(`[data-category="${catIndex}"][data-option="${optionIndex}"]`);

            if (selected === correct) {
                gameState.correctAnswers.add(catIndex);
                
                cells.forEach(cell => {
                    cell.classList.add('correct', 'locked');
                    cell.textContent = 'âœ“';
                });

                showResult(true);
                
                setTimeout(() => {
                    document.getElementById('modal').classList.remove('active');
                    
                    if (gameState.correctAnswers.size === categories.length) {
                        setTimeout(() => showVictory(), 500);
                    }
                }, 1500);
            } else {
                selectedCell.classList.add('incorrect', 'shake');
                selectedCell.textContent = 'âœ—';
                
                setTimeout(() => {
                    selectedCell.classList.remove('shake');
                }, 400);

                showResult(false);
                
                setTimeout(() => {
                    document.getElementById('modal').classList.remove('active');
                }, 1500);
            }

            updateStats();
        }

        function showResult(isCorrect) {
            const content = document.getElementById('modalContent');
            content.innerHTML = `
                <div class="result-message ${isCorrect ? 'correct' : 'incorrect'}">
                    ${isCorrect ? 'Â¡Correcto!' : 'Incorrecto'}
                </div>
            `;
        }

        function showVictory() {
            const modal = document.getElementById('modal');
            const content = document.getElementById('modalContent');

            content.innerHTML = `
                <div class="victory-modal">
                    <div class="victory-title">ðŸŽ‰</div>
                    <div class="victory-message">Â¡Enhorabuena!</div>
                    <div class="victory-stats">
                        <p><strong>Has completado el trivial</strong></p>
                        <p>Total de intentos: <strong>${gameState.attempts}</strong></p>
                        <p>CategorÃ­as acertadas: <strong>${gameState.correctAnswers.size}/${categories.length}</strong></p>
                    </div>
                    <button class="btn" onclick="playAgain()">Jugar de Nuevo</button>
                </div>
            `;

            modal.classList.add('active');
        }

        function playAgain() {
            document.getElementById('modal').classList.remove('active');
            resetGame();
        }

        function updateStats() {
            document.getElementById('attempts').textContent = gameState.attempts;
            document.getElementById('progress').textContent = `${gameState.correctAnswers.size}/${categories.length}`;
        }

        function resetGame() {
            gameState = {
                attempts: 0,
                correctAnswers: new Set(),
                currentRound: {}
            };
            initGrid();
            updateStats();
        }

        function toggleTheme() {
            document.body.style.background = document.body.style.background === 'rgb(51, 51, 51)' ? '#f5f5f5' : '#333';
            document.querySelector('.theme-toggle').textContent = 
                document.body.style.background === 'rgb(51, 51, 51)' ? 'â˜€ï¸' : 'ðŸŒ™';
        }

        document.getElementById('modal').onclick = (e) => {
            if (e.target.id === 'modal') {
                e.target.classList.remove('active');
            }
        };

        initGrid();
    </script>
</body>
</html>
